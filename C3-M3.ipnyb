{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "![Banner-Introducci-n.png](https://i.postimg.cc/VkCcqsvv/Banner-Introducci-n.png)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Introducción a ciencia de datos\n",
    "\n",
    "\n",
    "## L2:Tablas de contingencia y pruebas chi cuadrado\n",
    "\n",
    "De acuerdo con el caso de uso del sector **retail**  se van a desarrollar en los temas vistos en las infografías y videos anteriores\n",
    "\n",
    "### Objetivos\n",
    "1. Entender la construcción de una tabla de contingencia\n",
    "2. Identificar los perfiles filas y perfiles columna\n",
    "3. Interpretar la hipótesis encontrada con la prueba chi cuadrado"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Autor:** David Ocampo\n",
    "\n",
    "d.ocampo@uniandes.edu.co"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 1. Contexto del caso\n",
    "La compañía está muy interesada en generar estrategias de ventas más focalizadas tanto en productos como en los departamentos de ventas de este, por lo tanto se debe guiar un análisis que nos muestre cuáles posibles relaciones existen entre estas dos variables para generar las estrategias comerciales correctas tanto en aliados como en distribución. Se debe conducir una prueba piloto con los departamentos con más ventas así como los productos que se venden mas."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2. Importación de librerías y archivos\n",
    "En las siguientes líneas de código se importaran los materiales de trabajo necesarios para desarrollar el caso de uso, en esto se incluyen las *librerías y los datos*"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Importar las librerías necesarias según el análisis que se vaya a realizar\n",
    "# Librería para comando de sistema\n",
    "import os\n",
    "# Librería para manejo de datos\n",
    "import pandas as pd\n",
    "# Librería para el test chi cuadrado\n",
    "from scipy.stats import chi2_contingency\n",
    "from scipy.stats import chi2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "# cargar los datos en csv\n",
    "data= pd.read_csv('Ordenes_productos_C1_M3.csv', sep=';',encoding='latin-1')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Es importante tener en cuenta la visualización de los datos porque además de contexto se puede entender mucho mejor de qué se está hablando y qué tipos de datos se han cargado desde la máquina"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>orden_id</th>\n",
       "      <th>order_item_id</th>\n",
       "      <th>producto_id</th>\n",
       "      <th>vendedor_id</th>\n",
       "      <th>fecha_envio_limite</th>\n",
       "      <th>precio</th>\n",
       "      <th>valor_flete</th>\n",
       "      <th>codigo_postal_vendedor</th>\n",
       "      <th>ciudad_vendedor</th>\n",
       "      <th>departamento_vendedor</th>\n",
       "      <th>nombre_categoria_producto</th>\n",
       "      <th>longitud_nombre_producto</th>\n",
       "      <th>longitud_descripcion_producto</th>\n",
       "      <th>cantidad_fotos_producto</th>\n",
       "      <th>peso_g_producto</th>\n",
       "      <th>longitud_cm_producto</th>\n",
       "      <th>altura_cm_producto</th>\n",
       "      <th>ancho_cm_producto</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>107500PO59A</td>\n",
       "      <td>A</td>\n",
       "      <td>PO59</td>\n",
       "      <td>VE5389</td>\n",
       "      <td>07/04/2018 18:12</td>\n",
       "      <td>271.86</td>\n",
       "      <td>30.72</td>\n",
       "      <td>70001</td>\n",
       "      <td>Sincelejo</td>\n",
       "      <td>Sucre</td>\n",
       "      <td>Productos ecoamigables</td>\n",
       "      <td>6</td>\n",
       "      <td>7</td>\n",
       "      <td>27</td>\n",
       "      <td>2486</td>\n",
       "      <td>17</td>\n",
       "      <td>11</td>\n",
       "      <td>14</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>37493PS22B</td>\n",
       "      <td>B</td>\n",
       "      <td>PS22</td>\n",
       "      <td>VE1558</td>\n",
       "      <td>20/10/2017 09:07</td>\n",
       "      <td>115.73</td>\n",
       "      <td>4.68</td>\n",
       "      <td>66001</td>\n",
       "      <td>Pereira</td>\n",
       "      <td>Risaralda</td>\n",
       "      <td>Carnicería</td>\n",
       "      <td>10</td>\n",
       "      <td>31</td>\n",
       "      <td>20</td>\n",
       "      <td>256</td>\n",
       "      <td>43</td>\n",
       "      <td>2</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>28050PK20B</td>\n",
       "      <td>B</td>\n",
       "      <td>PK20</td>\n",
       "      <td>VE9159</td>\n",
       "      <td>17/08/2017 08:15</td>\n",
       "      <td>432.99</td>\n",
       "      <td>82.70</td>\n",
       "      <td>8001</td>\n",
       "      <td>Barranquilla</td>\n",
       "      <td>Atlantico</td>\n",
       "      <td>Deportes</td>\n",
       "      <td>25</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>5270</td>\n",
       "      <td>9</td>\n",
       "      <td>27</td>\n",
       "      <td>29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>52187PA10A</td>\n",
       "      <td>A</td>\n",
       "      <td>PA10</td>\n",
       "      <td>VE3159</td>\n",
       "      <td>23/09/2017 23:27</td>\n",
       "      <td>108.38</td>\n",
       "      <td>35.39</td>\n",
       "      <td>18001</td>\n",
       "      <td>Florencia</td>\n",
       "      <td>Caqueta</td>\n",
       "      <td>Electrodomésticos</td>\n",
       "      <td>10</td>\n",
       "      <td>1</td>\n",
       "      <td>6</td>\n",
       "      <td>734</td>\n",
       "      <td>46</td>\n",
       "      <td>48</td>\n",
       "      <td>22</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>84639PR12A</td>\n",
       "      <td>A</td>\n",
       "      <td>PR12</td>\n",
       "      <td>VE5090</td>\n",
       "      <td>07/01/2018 11:50</td>\n",
       "      <td>51.50</td>\n",
       "      <td>11.10</td>\n",
       "      <td>11001</td>\n",
       "      <td>Bogota d.c.</td>\n",
       "      <td>Bogota d.c.</td>\n",
       "      <td>Frutas y verduras</td>\n",
       "      <td>23</td>\n",
       "      <td>16</td>\n",
       "      <td>35</td>\n",
       "      <td>884</td>\n",
       "      <td>45</td>\n",
       "      <td>26</td>\n",
       "      <td>18</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      orden_id order_item_id producto_id vendedor_id fecha_envio_limite  \\\n",
       "0  107500PO59A             A        PO59      VE5389   07/04/2018 18:12   \n",
       "1   37493PS22B             B        PS22      VE1558   20/10/2017 09:07   \n",
       "2   28050PK20B             B        PK20      VE9159   17/08/2017 08:15   \n",
       "3   52187PA10A             A        PA10      VE3159   23/09/2017 23:27   \n",
       "4   84639PR12A             A        PR12      VE5090   07/01/2018 11:50   \n",
       "\n",
       "   precio  valor_flete  codigo_postal_vendedor ciudad_vendedor  \\\n",
       "0  271.86        30.72                   70001       Sincelejo   \n",
       "1  115.73         4.68                   66001         Pereira   \n",
       "2  432.99        82.70                    8001    Barranquilla   \n",
       "3  108.38        35.39                   18001       Florencia   \n",
       "4   51.50        11.10                   11001     Bogota d.c.   \n",
       "\n",
       "  departamento_vendedor nombre_categoria_producto  longitud_nombre_producto  \\\n",
       "0                 Sucre    Productos ecoamigables                         6   \n",
       "1             Risaralda                Carnicería                        10   \n",
       "2             Atlantico                  Deportes                        25   \n",
       "3               Caqueta         Electrodomésticos                        10   \n",
       "4           Bogota d.c.         Frutas y verduras                        23   \n",
       "\n",
       "   longitud_descripcion_producto  cantidad_fotos_producto  peso_g_producto  \\\n",
       "0                              7                       27             2486   \n",
       "1                             31                       20              256   \n",
       "2                              5                        4             5270   \n",
       "3                              1                        6              734   \n",
       "4                             16                       35              884   \n",
       "\n",
       "   longitud_cm_producto  altura_cm_producto  ancho_cm_producto  \n",
       "0                    17                  11                 14  \n",
       "1                    43                   2                 21  \n",
       "2                     9                  27                 29  \n",
       "3                    46                  48                 22  \n",
       "4                    45                  26                 18  "
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#visualizar los primeros registros\n",
    "data.head(5)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 3. Tablas de contingencia\n",
    "La tabla de contingencia es una de las técnicas para explorar dos o incluso más variables. Básicamente es un recuento de recuentos entre dos o más variables categóricas. La información sin procesar puede ser difícil de interpretar. Incluso para pequeños conjuntos de datos, es demasiado fácil obtener resultados incorrectos con solo mirar los datos. La tabla ofrece un método simple de agrupar variables, que minimiza el potencial de confusión o error al proporcionar resultados claros.\n",
    "\n",
    "**Hipótesis:** El departamento donde se concentran los top 5 productos es NARIÑO"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>nombre_categoria_producto</th>\n",
       "      <th>producto_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>Tecnología</td>\n",
       "      <td>543</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Deportes</td>\n",
       "      <td>537</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Frutas y verduras</td>\n",
       "      <td>532</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Carnicería</td>\n",
       "      <td>523</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>Ropa de adultos</td>\n",
       "      <td>521</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   nombre_categoria_producto  producto_id\n",
       "19                Tecnología          543\n",
       "3                   Deportes          537\n",
       "7          Frutas y verduras          532\n",
       "1                 Carnicería          523\n",
       "15           Ropa de adultos          521"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#buscar los top 5  categorías de productos \n",
    "categoria_top=data.groupby('nombre_categoria_producto').count().reset_index()[['nombre_categoria_producto','producto_id']].sort_values(by=['producto_id'], ascending=False)\n",
    "categoria_top_lista=categoria_top.head()['nombre_categoria_producto']\n",
    "categoria_top.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>departamento_vendedor</th>\n",
       "      <th>producto_id</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>Nariño</td>\n",
       "      <td>3648</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>Meta</td>\n",
       "      <td>1258</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>Norte de santander</td>\n",
       "      <td>473</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>Risaralda</td>\n",
       "      <td>405</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>Caldas</td>\n",
       "      <td>378</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   departamento_vendedor  producto_id\n",
       "21                Nariño         3648\n",
       "20                  Meta         1258\n",
       "22    Norte de santander          473\n",
       "25             Risaralda          405\n",
       "7                 Caldas          378"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Encontrar los departamentos top 5\n",
    "departamento_top=data.groupby('departamento_vendedor').count().reset_index()[['departamento_vendedor','producto_id']].sort_values(by=['producto_id'], ascending=False)\n",
    "departamento_top_lista=departamento_top.head()['departamento_vendedor'].to_list()\n",
    "departamento_top.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>orden_id</th>\n",
       "      <th>order_item_id</th>\n",
       "      <th>producto_id</th>\n",
       "      <th>vendedor_id</th>\n",
       "      <th>fecha_envio_limite</th>\n",
       "      <th>precio</th>\n",
       "      <th>valor_flete</th>\n",
       "      <th>codigo_postal_vendedor</th>\n",
       "      <th>ciudad_vendedor</th>\n",
       "      <th>departamento_vendedor</th>\n",
       "      <th>nombre_categoria_producto</th>\n",
       "      <th>longitud_nombre_producto</th>\n",
       "      <th>longitud_descripcion_producto</th>\n",
       "      <th>cantidad_fotos_producto</th>\n",
       "      <th>peso_g_producto</th>\n",
       "      <th>longitud_cm_producto</th>\n",
       "      <th>altura_cm_producto</th>\n",
       "      <th>ancho_cm_producto</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>37493PS22B</td>\n",
       "      <td>B</td>\n",
       "      <td>PS22</td>\n",
       "      <td>VE1558</td>\n",
       "      <td>20/10/2017 09:07</td>\n",
       "      <td>115.73</td>\n",
       "      <td>4.68</td>\n",
       "      <td>66001</td>\n",
       "      <td>Pereira</td>\n",
       "      <td>Risaralda</td>\n",
       "      <td>Carnicería</td>\n",
       "      <td>10</td>\n",
       "      <td>31</td>\n",
       "      <td>20</td>\n",
       "      <td>256</td>\n",
       "      <td>43</td>\n",
       "      <td>2</td>\n",
       "      <td>21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>73003PS37A</td>\n",
       "      <td>A</td>\n",
       "      <td>PS37</td>\n",
       "      <td>VE3806</td>\n",
       "      <td>09/12/2017 16:52</td>\n",
       "      <td>132.51</td>\n",
       "      <td>33.68</td>\n",
       "      <td>52323</td>\n",
       "      <td>Gualmatan</td>\n",
       "      <td>Nariño</td>\n",
       "      <td>Carnicería</td>\n",
       "      <td>13</td>\n",
       "      <td>19</td>\n",
       "      <td>29</td>\n",
       "      <td>811</td>\n",
       "      <td>29</td>\n",
       "      <td>9</td>\n",
       "      <td>16</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>41673PB76A</td>\n",
       "      <td>A</td>\n",
       "      <td>PB76</td>\n",
       "      <td>VE2456</td>\n",
       "      <td>11/02/2018 20:04</td>\n",
       "      <td>420.95</td>\n",
       "      <td>12.19</td>\n",
       "      <td>50006</td>\n",
       "      <td>Acacias</td>\n",
       "      <td>Meta</td>\n",
       "      <td>Ropa de adultos</td>\n",
       "      <td>8</td>\n",
       "      <td>37</td>\n",
       "      <td>24</td>\n",
       "      <td>621</td>\n",
       "      <td>26</td>\n",
       "      <td>41</td>\n",
       "      <td>29</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>89816PE75A</td>\n",
       "      <td>A</td>\n",
       "      <td>PE75</td>\n",
       "      <td>VE3939</td>\n",
       "      <td>06/04/2018 20:43</td>\n",
       "      <td>42.16</td>\n",
       "      <td>16.63</td>\n",
       "      <td>54001</td>\n",
       "      <td>Cucuta</td>\n",
       "      <td>Norte de santander</td>\n",
       "      <td>Tecnología</td>\n",
       "      <td>0</td>\n",
       "      <td>33</td>\n",
       "      <td>30</td>\n",
       "      <td>75</td>\n",
       "      <td>7</td>\n",
       "      <td>34</td>\n",
       "      <td>44</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>39</th>\n",
       "      <td>97099PB61A</td>\n",
       "      <td>A</td>\n",
       "      <td>PB61</td>\n",
       "      <td>VE5090</td>\n",
       "      <td>01/09/2017 03:19</td>\n",
       "      <td>155.20</td>\n",
       "      <td>29.78</td>\n",
       "      <td>54003</td>\n",
       "      <td>Abrego</td>\n",
       "      <td>Norte de santander</td>\n",
       "      <td>Ropa de adultos</td>\n",
       "      <td>11</td>\n",
       "      <td>2</td>\n",
       "      <td>11</td>\n",
       "      <td>118</td>\n",
       "      <td>38</td>\n",
       "      <td>36</td>\n",
       "      <td>46</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      orden_id order_item_id producto_id vendedor_id fecha_envio_limite  \\\n",
       "1   37493PS22B             B        PS22      VE1558   20/10/2017 09:07   \n",
       "5   73003PS37A             A        PS37      VE3806   09/12/2017 16:52   \n",
       "6   41673PB76A             A        PB76      VE2456   11/02/2018 20:04   \n",
       "23  89816PE75A             A        PE75      VE3939   06/04/2018 20:43   \n",
       "39  97099PB61A             A        PB61      VE5090   01/09/2017 03:19   \n",
       "\n",
       "    precio  valor_flete  codigo_postal_vendedor ciudad_vendedor  \\\n",
       "1   115.73         4.68                   66001         Pereira   \n",
       "5   132.51        33.68                   52323       Gualmatan   \n",
       "6   420.95        12.19                   50006         Acacias   \n",
       "23   42.16        16.63                   54001          Cucuta   \n",
       "39  155.20        29.78                   54003          Abrego   \n",
       "\n",
       "   departamento_vendedor nombre_categoria_producto  longitud_nombre_producto  \\\n",
       "1              Risaralda                Carnicería                        10   \n",
       "5                 Nariño                Carnicería                        13   \n",
       "6                   Meta           Ropa de adultos                         8   \n",
       "23    Norte de santander                Tecnología                         0   \n",
       "39    Norte de santander           Ropa de adultos                        11   \n",
       "\n",
       "    longitud_descripcion_producto  cantidad_fotos_producto  peso_g_producto  \\\n",
       "1                              31                       20              256   \n",
       "5                              19                       29              811   \n",
       "6                              37                       24              621   \n",
       "23                             33                       30               75   \n",
       "39                              2                       11              118   \n",
       "\n",
       "    longitud_cm_producto  altura_cm_producto  ancho_cm_producto  \n",
       "1                     43                   2                 21  \n",
       "5                     29                   9                 16  \n",
       "6                     26                  41                 29  \n",
       "23                     7                  34                 44  \n",
       "39                    38                  36                 46  "
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#filtrar por los departamentos top\n",
    "data_top=data[data['nombre_categoria_producto'].isin(categoria_top_lista) & data['departamento_vendedor'].isin(departamento_top_lista)]\n",
    "data_top.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Una vez realizado el filtrado de los productos top y las categorías top se realiza la tabla de contingencia para analizar cómo se distribuyen las ventas departamento vs categoría"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>departamento_vendedor</th>\n",
       "      <th>Caldas</th>\n",
       "      <th>Meta</th>\n",
       "      <th>Nariño</th>\n",
       "      <th>Norte de santander</th>\n",
       "      <th>Risaralda</th>\n",
       "      <th>All</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>nombre_categoria_producto</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Carnicería</th>\n",
       "      <td>19</td>\n",
       "      <td>63</td>\n",
       "      <td>185</td>\n",
       "      <td>26</td>\n",
       "      <td>13</td>\n",
       "      <td>306</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Deportes</th>\n",
       "      <td>22</td>\n",
       "      <td>60</td>\n",
       "      <td>193</td>\n",
       "      <td>21</td>\n",
       "      <td>25</td>\n",
       "      <td>321</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Frutas y verduras</th>\n",
       "      <td>18</td>\n",
       "      <td>58</td>\n",
       "      <td>192</td>\n",
       "      <td>43</td>\n",
       "      <td>32</td>\n",
       "      <td>343</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ropa de adultos</th>\n",
       "      <td>17</td>\n",
       "      <td>66</td>\n",
       "      <td>184</td>\n",
       "      <td>22</td>\n",
       "      <td>32</td>\n",
       "      <td>321</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Tecnología</th>\n",
       "      <td>26</td>\n",
       "      <td>71</td>\n",
       "      <td>202</td>\n",
       "      <td>31</td>\n",
       "      <td>18</td>\n",
       "      <td>348</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>All</th>\n",
       "      <td>102</td>\n",
       "      <td>318</td>\n",
       "      <td>956</td>\n",
       "      <td>143</td>\n",
       "      <td>120</td>\n",
       "      <td>1639</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "departamento_vendedor      Caldas  Meta  Nariño  Norte de santander  \\\n",
       "nombre_categoria_producto                                             \n",
       "Carnicería                     19    63     185                  26   \n",
       "Deportes                       22    60     193                  21   \n",
       "Frutas y verduras              18    58     192                  43   \n",
       "Ropa de adultos                17    66     184                  22   \n",
       "Tecnología                     26    71     202                  31   \n",
       "All                           102   318     956                 143   \n",
       "\n",
       "departamento_vendedor      Risaralda   All  \n",
       "nombre_categoria_producto                   \n",
       "Carnicería                        13   306  \n",
       "Deportes                          25   321  \n",
       "Frutas y verduras                 32   343  \n",
       "Ropa de adultos                   32   321  \n",
       "Tecnología                        18   348  \n",
       "All                              120  1639  "
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#realizar la tabla de contingencia\n",
    "tabla_contingencia=pd.crosstab(data_top['nombre_categoria_producto'],data['departamento_vendedor'],margins = True)\n",
    "tabla_contingencia"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Análisis: Rápidamente podemos ver que el departamento Nariño en efecto es el que mayormente genera ventas de las categorías top, ahora vamos a extender el análisis por filas y columnas para identificar diferentes tipos de hipótesis"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 3.1. Análisis fila\n",
    "Al construir una tabla de contingencia, en cada celda se coloca el total de casos que cumplen las categorías donde se cruzan. Para calcular los porcentajes por filas, se divide el número de casos de cada casilla, con el total de casos de la fila.\n",
    "\n",
    "**Hipótesis:** Es claro que la mayor cantidad de ventas se va a concentrar en Nariño, por lo tanto la organización quiere analizar si la categoría Frutas y verduras y Ropa de adultos tienen alguna ciudad de preferencia de ventas"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>departamento_vendedor</th>\n",
       "      <th>Caldas</th>\n",
       "      <th>Meta</th>\n",
       "      <th>Nariño</th>\n",
       "      <th>Norte de santander</th>\n",
       "      <th>Risaralda</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>nombre_categoria_producto</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Carnicería</th>\n",
       "      <td>0.062092</td>\n",
       "      <td>0.205882</td>\n",
       "      <td>0.604575</td>\n",
       "      <td>0.084967</td>\n",
       "      <td>0.042484</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Deportes</th>\n",
       "      <td>0.068536</td>\n",
       "      <td>0.186916</td>\n",
       "      <td>0.601246</td>\n",
       "      <td>0.065421</td>\n",
       "      <td>0.077882</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Frutas y verduras</th>\n",
       "      <td>0.052478</td>\n",
       "      <td>0.169096</td>\n",
       "      <td>0.559767</td>\n",
       "      <td>0.125364</td>\n",
       "      <td>0.093294</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ropa de adultos</th>\n",
       "      <td>0.052960</td>\n",
       "      <td>0.205607</td>\n",
       "      <td>0.573209</td>\n",
       "      <td>0.068536</td>\n",
       "      <td>0.099688</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Tecnología</th>\n",
       "      <td>0.074713</td>\n",
       "      <td>0.204023</td>\n",
       "      <td>0.580460</td>\n",
       "      <td>0.089080</td>\n",
       "      <td>0.051724</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>All</th>\n",
       "      <td>0.062233</td>\n",
       "      <td>0.194021</td>\n",
       "      <td>0.583282</td>\n",
       "      <td>0.087248</td>\n",
       "      <td>0.073215</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "departamento_vendedor        Caldas      Meta    Nariño  Norte de santander  \\\n",
       "nombre_categoria_producto                                                     \n",
       "Carnicería                 0.062092  0.205882  0.604575            0.084967   \n",
       "Deportes                   0.068536  0.186916  0.601246            0.065421   \n",
       "Frutas y verduras          0.052478  0.169096  0.559767            0.125364   \n",
       "Ropa de adultos            0.052960  0.205607  0.573209            0.068536   \n",
       "Tecnología                 0.074713  0.204023  0.580460            0.089080   \n",
       "All                        0.062233  0.194021  0.583282            0.087248   \n",
       "\n",
       "departamento_vendedor      Risaralda  \n",
       "nombre_categoria_producto             \n",
       "Carnicería                  0.042484  \n",
       "Deportes                    0.077882  \n",
       "Frutas y verduras           0.093294  \n",
       "Ropa de adultos             0.099688  \n",
       "Tecnología                  0.051724  \n",
       "All                         0.073215  "
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.crosstab(data_top['nombre_categoria_producto'],data['departamento_vendedor'],margins = True, normalize='index')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Análisis: Para el caso de Frutas y verduras vemos que donde más se vende es en el departamento de Nariño adicionalmente se da el caso para la categoría de ropa de adultos, sin embargo como nos estamos fijando en los departamentos que le siguen en ventas, vemos que para Frutas y verduras así como para ropa de adultos su competidor es el departamento del Meta "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 3.2. Análisis columna\n",
    "De manera análoga para calcular los porcentajes por columnas, se divide el número de casos de cada casilla, con el total de casos de la columna.\n",
    "\n",
    "**Hipótesis:** Es necesario identificar en que departamento se tienen la mayor cantidad de ventas en las categoría de Frutas y verduras y la ropa de adultos"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>departamento_vendedor</th>\n",
       "      <th>Caldas</th>\n",
       "      <th>Meta</th>\n",
       "      <th>Nariño</th>\n",
       "      <th>Norte de santander</th>\n",
       "      <th>Risaralda</th>\n",
       "      <th>All</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>nombre_categoria_producto</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Carnicería</th>\n",
       "      <td>0.186275</td>\n",
       "      <td>0.198113</td>\n",
       "      <td>0.193515</td>\n",
       "      <td>0.181818</td>\n",
       "      <td>0.108333</td>\n",
       "      <td>0.186699</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Deportes</th>\n",
       "      <td>0.215686</td>\n",
       "      <td>0.188679</td>\n",
       "      <td>0.201883</td>\n",
       "      <td>0.146853</td>\n",
       "      <td>0.208333</td>\n",
       "      <td>0.195851</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Frutas y verduras</th>\n",
       "      <td>0.176471</td>\n",
       "      <td>0.182390</td>\n",
       "      <td>0.200837</td>\n",
       "      <td>0.300699</td>\n",
       "      <td>0.266667</td>\n",
       "      <td>0.209274</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ropa de adultos</th>\n",
       "      <td>0.166667</td>\n",
       "      <td>0.207547</td>\n",
       "      <td>0.192469</td>\n",
       "      <td>0.153846</td>\n",
       "      <td>0.266667</td>\n",
       "      <td>0.195851</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Tecnología</th>\n",
       "      <td>0.254902</td>\n",
       "      <td>0.223270</td>\n",
       "      <td>0.211297</td>\n",
       "      <td>0.216783</td>\n",
       "      <td>0.150000</td>\n",
       "      <td>0.212325</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "departamento_vendedor        Caldas      Meta    Nariño  Norte de santander  \\\n",
       "nombre_categoria_producto                                                     \n",
       "Carnicería                 0.186275  0.198113  0.193515            0.181818   \n",
       "Deportes                   0.215686  0.188679  0.201883            0.146853   \n",
       "Frutas y verduras          0.176471  0.182390  0.200837            0.300699   \n",
       "Ropa de adultos            0.166667  0.207547  0.192469            0.153846   \n",
       "Tecnología                 0.254902  0.223270  0.211297            0.216783   \n",
       "\n",
       "departamento_vendedor      Risaralda       All  \n",
       "nombre_categoria_producto                       \n",
       "Carnicería                  0.108333  0.186699  \n",
       "Deportes                    0.208333  0.195851  \n",
       "Frutas y verduras           0.266667  0.209274  \n",
       "Ropa de adultos             0.266667  0.195851  \n",
       "Tecnología                  0.150000  0.212325  "
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "pd.crosstab(data_top['nombre_categoria_producto'],data['departamento_vendedor'],margins = True, normalize='columns')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Análisis: Para el departamento Nariño no se vende es Frutas y verduras tanto como en Norte de Santander, adicionalmente no ocurre con la categoría de Ropa de adultos que se vende en su mayoría en Risaralda"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 3.3. Análisis de totales\n",
    "\n",
    "El objetivo de esta técnica estadística es averiguar si las dos variables están relacionadas y la manera de averiguarlo es mediante la distribución de porcentajes. Concretamente se trata de analizar si la distribución de porcentajes de una variable se repiten por igual en las categorías de la otra variable.\n",
    "\n",
    "**Hipótesis:** Es posible identificar cuál es el producto que menos se vende en todas las ciudades"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>departamento_vendedor</th>\n",
       "      <th>Caldas</th>\n",
       "      <th>Meta</th>\n",
       "      <th>Nariño</th>\n",
       "      <th>Norte de santander</th>\n",
       "      <th>Risaralda</th>\n",
       "      <th>All</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>nombre_categoria_producto</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Carnicería</th>\n",
       "      <td>0.011592</td>\n",
       "      <td>0.038438</td>\n",
       "      <td>0.112874</td>\n",
       "      <td>0.015863</td>\n",
       "      <td>0.007932</td>\n",
       "      <td>0.186699</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Deportes</th>\n",
       "      <td>0.013423</td>\n",
       "      <td>0.036608</td>\n",
       "      <td>0.117755</td>\n",
       "      <td>0.012813</td>\n",
       "      <td>0.015253</td>\n",
       "      <td>0.195851</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Frutas y verduras</th>\n",
       "      <td>0.010982</td>\n",
       "      <td>0.035387</td>\n",
       "      <td>0.117145</td>\n",
       "      <td>0.026236</td>\n",
       "      <td>0.019524</td>\n",
       "      <td>0.209274</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ropa de adultos</th>\n",
       "      <td>0.010372</td>\n",
       "      <td>0.040268</td>\n",
       "      <td>0.112264</td>\n",
       "      <td>0.013423</td>\n",
       "      <td>0.019524</td>\n",
       "      <td>0.195851</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Tecnología</th>\n",
       "      <td>0.015863</td>\n",
       "      <td>0.043319</td>\n",
       "      <td>0.123246</td>\n",
       "      <td>0.018914</td>\n",
       "      <td>0.010982</td>\n",
       "      <td>0.212325</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>All</th>\n",
       "      <td>0.062233</td>\n",
       "      <td>0.194021</td>\n",
       "      <td>0.583282</td>\n",
       "      <td>0.087248</td>\n",
       "      <td>0.073215</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "departamento_vendedor        Caldas      Meta    Nariño  Norte de santander  \\\n",
       "nombre_categoria_producto                                                     \n",
       "Carnicería                 0.011592  0.038438  0.112874            0.015863   \n",
       "Deportes                   0.013423  0.036608  0.117755            0.012813   \n",
       "Frutas y verduras          0.010982  0.035387  0.117145            0.026236   \n",
       "Ropa de adultos            0.010372  0.040268  0.112264            0.013423   \n",
       "Tecnología                 0.015863  0.043319  0.123246            0.018914   \n",
       "All                        0.062233  0.194021  0.583282            0.087248   \n",
       "\n",
       "departamento_vendedor      Risaralda       All  \n",
       "nombre_categoria_producto                       \n",
       "Carnicería                  0.007932  0.186699  \n",
       "Deportes                    0.015253  0.195851  \n",
       "Frutas y verduras           0.019524  0.209274  \n",
       "Ropa de adultos             0.019524  0.195851  \n",
       "Tecnología                  0.010982  0.212325  \n",
       "All                         0.073215  1.000000  "
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# tabla de contingencia con porcentajes\n",
    "pd.crosstab(data_top['nombre_categoria_producto'],data['departamento_vendedor'],margins = True, normalize='all')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>departamento_vendedor</th>\n",
       "      <th>Caldas</th>\n",
       "      <th>Meta</th>\n",
       "      <th>Nariño</th>\n",
       "      <th>Norte de santander</th>\n",
       "      <th>Risaralda</th>\n",
       "      <th>All</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>nombre_categoria_producto</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Carnicería</th>\n",
       "      <td>19</td>\n",
       "      <td>63</td>\n",
       "      <td>185</td>\n",
       "      <td>26</td>\n",
       "      <td>13</td>\n",
       "      <td>306</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Deportes</th>\n",
       "      <td>22</td>\n",
       "      <td>60</td>\n",
       "      <td>193</td>\n",
       "      <td>21</td>\n",
       "      <td>25</td>\n",
       "      <td>321</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Frutas y verduras</th>\n",
       "      <td>18</td>\n",
       "      <td>58</td>\n",
       "      <td>192</td>\n",
       "      <td>43</td>\n",
       "      <td>32</td>\n",
       "      <td>343</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Ropa de adultos</th>\n",
       "      <td>17</td>\n",
       "      <td>66</td>\n",
       "      <td>184</td>\n",
       "      <td>22</td>\n",
       "      <td>32</td>\n",
       "      <td>321</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Tecnología</th>\n",
       "      <td>26</td>\n",
       "      <td>71</td>\n",
       "      <td>202</td>\n",
       "      <td>31</td>\n",
       "      <td>18</td>\n",
       "      <td>348</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>All</th>\n",
       "      <td>102</td>\n",
       "      <td>318</td>\n",
       "      <td>956</td>\n",
       "      <td>143</td>\n",
       "      <td>120</td>\n",
       "      <td>1639</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "departamento_vendedor      Caldas  Meta  Nariño  Norte de santander  \\\n",
       "nombre_categoria_producto                                             \n",
       "Carnicería                     19    63     185                  26   \n",
       "Deportes                       22    60     193                  21   \n",
       "Frutas y verduras              18    58     192                  43   \n",
       "Ropa de adultos                17    66     184                  22   \n",
       "Tecnología                     26    71     202                  31   \n",
       "All                           102   318     956                 143   \n",
       "\n",
       "departamento_vendedor      Risaralda   All  \n",
       "nombre_categoria_producto                   \n",
       "Carnicería                        13   306  \n",
       "Deportes                          25   321  \n",
       "Frutas y verduras                 32   343  \n",
       "Ropa de adultos                   32   321  \n",
       "Tecnología                        18   348  \n",
       "All                              120  1639  "
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "tabla_contingencia"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Análisis: Con la tabla de continecia de los porcentajes podemos identificar que el que menos se vende es los productos de carnicería con un porcentaje de apenas 18% de todas las ventas, esto lo podemos contrastar con la tabla totalizada con apenas 306 ventas, es importante ver que con esta ayuda de porcentajes el análisis es mucho más rápido y podemos al final corroborar con los datos originales, incluso con las funciones integradas podemos volver a confirmar."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "departamento_vendedor\n",
       "Caldas                 17\n",
       "Meta                   58\n",
       "Nariño                184\n",
       "Norte de santander     21\n",
       "Risaralda              13\n",
       "All                   306\n",
       "dtype: int64"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#utilizar el mínimo para columnas\n",
    "tabla_contingencia.min()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "nombre_categoria_producto\n",
       "Carnicería            13\n",
       "Deportes              21\n",
       "Frutas y verduras     18\n",
       "Ropa de adultos       17\n",
       "Tecnología            18\n",
       "All                  102\n",
       "dtype: int64"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#utilizar el mínimo para filas\n",
    "tabla_contingencia.transpose().min()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 4.Prueba Chi-cuadrado\n",
    "La prueba de chi-cuadrado es una prueba de hipótesis estadística que asume (la hipótesis nula) que las frecuencias observadas para una variable categórica coinciden con las frecuencias esperadas para la variable categórica. Para determinar la existencia o no de independencia entre dos variables. Que dos variables sean independientes significa que no tienen relación, y que por lo tanto una no depende de la otra, ni viceversa.\n",
    "Así, con el estudio de la independencia, se origina también un método para verificar si las frecuencias observadas en cada categoría son compatibles con la independencia entre ambas variables.\n",
    "\n",
    "**Hipótesis:** Las ventas de las categorías de productos no están relacionadas con el departamento que se venda\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "p-valor es:  0.48301469357016336\n",
      "chi=24.634237, valor crítico=37.652484\n",
      "\n",
      "A un 0.05 de nivel de significancia, no se rechaza la hipótesis nula. \n",
      "Son independientes, no tienen relación\n"
     ]
    }
   ],
   "source": [
    "#Establecer los valores del test chi cuadrado\n",
    "chi, pval, dof, exp = chi2_contingency(tabla_contingencia)\n",
    "\n",
    "# chi: valor del test\n",
    "# pval: p-valor del test\n",
    "# dof: grados de libertad\n",
    "\n",
    "#imprimir los resultados del test\n",
    "print('p-valor es: ', pval)\n",
    "\n",
    "# Establecer la significancia del test\n",
    "significancia = 0.05\n",
    "p = 1 - significancia\n",
    "\n",
    "#establecer el valor crítico\n",
    "valor_critico = chi2.ppf(p, dof)\n",
    "print('chi=%.6f, valor crítico=%.6f\\n' % (chi, valor_critico))\n",
    "\n",
    "#según el valor crítico se toma la decisión de rechazar o no la hipótesis \n",
    "if chi > valor_critico:\n",
    "    print(\"\"\"A un %.2f de nivel de significancia, se rechaza la hipótesis nula y se acepta H1. \n",
    "No son independientes, por lo tanto están correlacionados\"\"\" % (significancia))\n",
    "else:\n",
    "    print(\"\"\"A un %.2f de nivel de significancia, no se rechaza la hipótesis nula. \n",
    "Son independientes, no tienen relación\"\"\" % (significancia))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Análisis: Se puede establecer que no tienen algún tipo de relación las categorías y los sitios de venta, esto se puede dar por las características culturales de algún lugar, o por los habitos de consumo, lo que nos indica que podemos como organización podemos utilizar las mismas estrategias de venta independientemente del producto"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "![Banner-Introducci-n.png](https://i.postimg.cc/VkCcqsvv/Banner-Introducci-n.png)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.12"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
